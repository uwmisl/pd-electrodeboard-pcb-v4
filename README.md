# Electrode Board v4

KiCad design for PurpleDrop electrode board with improved heater conductance, designed for 100x74mm film carrier and 50x50mm top plate.

This project is designed with KiCad v5.1.5.

## PDF Documentation

For a quick look, there is a [Schematic](PD_ElectrodeBoard_v4/outputs/PD_ElectrodeBoard_v4.1_sch.pdf) and [PCB fab drawing](PD_ElectrodeBoard_v4/outputs/PD_ElectrodeBoard_v4.1_fab.pdf)

## Project structure

Much of the board design is auto-generated by python scripts.

`FootprintGenerator.ipynb` generates the electrode and reservoir footprints.
They are all designed such that their origin should fall on the center of the
electrode "grid" positions. For this design, the pitch of the electrodes is
2.25mm. This script will generate a number of footprints, e.g. `electrode_points_1_40deg_rl.kicad_mod`.
The naming convention says that this footprint has 1 point per edge, the angle
of the points is 40 degrees, and it has points on the right and left edge (the
top and bottom are flat).

`FiducialFootprintGenerator.ipynb` generates a silkscreen footprint from an image file
(see `TagImages` directory), to put [april tags](https://github.com/AprilRobotics/apriltag)
onto the board as fidicuals for image processing. Each tag has a unique ID to aid in
identifying which tag (as well as which version of electrode board) has been
detected.

`LayoutGenerator.ipynb` generates a layout.yaml file for this
[kicad component layout plugin](https://github.com/mcbridejc/kicad_component_layout/).
This positions the electrodes, and selects between the different edge variants (e.g. trbl, tr)
based on neighboring electrodes in the grid.

This makes the process of experimenting with different electrode footprints and
layouts easier. Once the electrodes are positioned, the routing to the connectors
is done manually.

## Revision History

### Version 4.1

- Shrinks width to fit reservoirs entirely under 50mmx50mm plate
- Corrects heater footprints
- Adds 2 internal layers to allow heaters to be located closer to the electrodes and
to provide additional thermal paths between them
- Flips connector pin labeling to match purpledrop
- 0.062" thick: 0.032" was not rigid enough
- Increases size of fiducials to 6mm and uses a unique value for each fiducial

### Version 4.0

Initial version

Issues:
- Undersized heating resistor footprints
- Mislabeled pin numbers (they do not match the purpledrop numbering)
- Fiducials were a bit too small; they silk screen resolution did not reproduce them well and sometimes they are difficult to detect
