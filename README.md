# Electrode Board v4

KiCad design for PurpleDrop electrode board with improved heat conductance, designed for 100x74mm film carrier and 50x50mm top plate.

This project is designed with KiCad v5.1.5.

## PDF Documentation

For a quick look, there is a [Schematic](PD_ElectrodeBoard_v4/outputs/PD_ElectrodeBoard_v4_sch.pdf) and [PCB fab drawing](PD_ElectrodeBoard_v4/outputs/PD_ElectrodeBoard_v4_fab.pdf)

## File structure

There are two board designs in this repo. The main electrode board is in `PD_ElectrodeBoard_v4` directory, and there is a very simple board in `spacer` which -- as the name suggests -- is used as a spacer for the solderable nuts that go on the corner mounting holes so that the nuts do not protrude through the front of the board.

Much of the main board is auto-generated by python scripts, which is a somewhat tedious process, but less tedious I thnk than designing it *without* the scripts.

`FootprintGenerator.ipynb` generates the electrode and reservoir footprints. They are all designed such that their origin should fall on the center of the electrode "grid" positions. For this design, the pitch of the electrodes is 2.5mm. This script will generate a number of footprints, e.g. `electrode_points_1_40deg_rl.kicad_mod`. The naming convention says that this footprint has 1 point per edge, the angle of the points is 40 degrees, and it has points on the right and left edge (the top and bottom are flat).

`FiducialFootprintGenerator.ipynb` generates a silkscreen footprint from an image file (see `TagImages` directory), to put an AprilTag onto the board as a fidicual for image processing.

`electrode_layout_plugin.py` is a KiCad plugin. It should be placed somewhere in the KiCad plugin search path (e.g. `~/.kicad/scripting`), so that KiCad finds it. Then a new toolbar button is created to run the plugin. It will read the `layout.yaml` file in the project directory, and use the information within to position the electrode and reservoir footprint (which should have already been manually created in the schematic). It will replace them with the appropriate edge variant (e.g. `tlbr` or `tl` etc) as well, so you can specify any footprint in the schematic; all parts with designator E1-E199 will be treated as an electrode.

`LayoutGenerator.ipynb` has some tools for generating a layout.yaml file.
